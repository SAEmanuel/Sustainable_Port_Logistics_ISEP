@startuml
actor Client
boundary QualificationsController
entity QualificationService
entity QualificationRepository
entity UnitOfWork
entity QualificationFactory
database "Qualifications Database" as Database

== Get All Qualifications ==
Client -> QualificationsController: GET /api/qualifications
QualificationsController -> QualificationService: GetAllAsync()
QualificationService -> QualificationRepository: GetAllAsync()
QualificationRepository -> Database: Query all records
Database --> QualificationRepository: List<Qualification>
QualificationRepository --> QualificationService: List<Qualification>
QualificationService -> QualificationFactory: CreateQualificationDtoList()
QualificationService --> QualificationsController: List<QualificationDto>
QualificationsController --> Client: 200 OK List<QualificationDto>

== Get Qualification By ID ==
Client -> QualificationsController: GET /api/qualifications/{id}
QualificationsController -> QualificationService: GetByIdAsync(QualificationId)
QualificationService -> QualificationRepository: GetByIdAsync(id)
QualificationRepository -> Database: Query by ID
Database --> QualificationRepository: Qualification or null
QualificationRepository --> QualificationService: Qualification or null
QualificationService -> QualificationFactory: CreateQualificationDto()
QualificationService --> QualificationsController: QualificationDto or 404
QualificationsController --> Client: 200 OK or 404

== Get Qualification By Code ==
Client -> QualificationsController: GET /api/qualifications/code/{code}
QualificationsController -> QualificationService: GetByCodeAsync(code)
QualificationService -> QualificationRepository: GetQualificationByCodeAsync(code)
QualificationRepository -> Database: Query by Code
Database --> QualificationRepository: Qualification or null
QualificationRepository --> QualificationService: Qualification or null
QualificationService -> QualificationFactory: CreateQualificationDto()
QualificationService --> QualificationsController: QualificationDto or 404
QualificationsController --> Client: 200 OK or 404

== Get Qualification By Name ==
Client -> QualificationsController: GET /api/qualifications/name/{name}
QualificationsController -> QualificationService: GetByNameAsync(name)
QualificationService -> QualificationRepository: GetQualificationByName(name)
QualificationRepository -> Database: Query by Name
Database --> QualificationRepository: Qualification or null
QualificationRepository --> QualificationService: Qualification or null
QualificationService -> QualificationFactory: CreateQualificationDto()
QualificationService --> QualificationsController: QualificationDto or 404
QualificationsController --> Client: 200 OK or 404

== Create Qualification ==
Client -> QualificationsController: POST /api/qualifications\nBody: CreatingQualificationDto
QualificationsController -> QualificationService: AddAsync(dto)
QualificationService -> QualificationService: EnsureNotRepeatedAsync(dto)
QualificationService -> QualificationService: GetCodeAsync(dto)
QualificationService -> QualificationRepository: AddAsync(Qualification)
QualificationRepository -> Database: Insert Record
Database --> QualificationRepository: Success
QualificationService -> UnitOfWork: CommitAsync()
UnitOfWork --> QualificationService: Success
QualificationService -> QualificationFactory: CreateQualificationDto()
QualificationService --> QualificationsController: QualificationDto
QualificationsController --> Client: 201 Created

== Update Qualification ==
Client -> QualificationsController: PATCH /api/qualifications/{id}\nBody: CreatingQualificationDto
QualificationsController -> QualificationService: UpdateAsync(QualificationId, dto)
QualificationService -> QualificationRepository: GetByIdAsync(id)
QualificationRepository -> Database: Query by ID
Database --> QualificationRepository: Qualification or null
QualificationRepository --> QualificationService: Qualification or null
QualificationService -> QualificationService: UpdateName and/or UpdateCode
QualificationService -> UnitOfWork: CommitAsync()
UnitOfWork --> QualificationService: Success
QualificationService -> QualificationFactory: CreateQualificationDto()
QualificationService --> QualificationsController: QualificationDto or 404
QualificationsController --> Client: 200 OK or 404

@enduml

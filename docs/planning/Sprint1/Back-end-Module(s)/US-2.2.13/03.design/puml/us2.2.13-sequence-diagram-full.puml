@startuml
actor "Logistics Operator" as Operator
boundary "UI" as UI
boundary "QualificationController" as Controller
control "QualificationAppService" as Service
entity "QualificationRepository" as Repository
collections "Audit Log" as Audit

Operator -> UI : Fill Qualification form (Code, Name) and submit
UI -> Controller : RegisterQualification(QualificationDTO)
Controller -> Controller : Validate basic fields (Code, Name)
alt Validation fails
    Controller --> UI : Return ValidationErrorsDTO
    UI --> Operator : Display validation errors
else Validation succeeds
    Controller -> Service : CreateQualification(QualificationDTO)
    Service -> Service : Validate business rules (code uniqueness, etc.)
    alt Business validation fails
        Service --> Controller : Return Business ValidationErrorsDTO
        Controller --> UI : Return Business ValidationErrorsDTO
        UI --> Operator : Display business validation errors
    else Business validation succeeds
        Service -> Repository : Save Qualification entity
        Repository --> Service : Qualification entity with Id
        Service -> Audit : Log creation event
        Service --> Controller : Return QualificationSuccessDTO
        Controller --> UI : Return QualificationSuccessDTO
        UI --> Operator : Display success message
    end
end

== Update Qualification ==

Operator -> UI : Request to update Qualification (Id, new Code, new Name)
UI -> Controller : UpdateQualification(QualificationDTO)
Controller -> Controller : Validate fields
alt Validation fails
    Controller --> UI : Return ValidationErrorsDTO
    UI --> Operator : Display validation errors
else Validation succeeds
    Controller -> Service : UpdateQualification(QualificationDTO)
    Service -> Service : Validate business rules (unique code, validate relationships)
    alt Business validation fails
        Service --> Controller : Return Business ValidationErrorsDTO
        Controller --> UI : Return Business ValidationErrorsDTO
        UI --> Operator : Display business validation errors
    else Business validation succeeds
        Service -> Repository : Update Qualification entity
        Repository --> Service : Updated Qualification entity
        Service -> Audit : Log update event
        Service --> Controller : Return QualificationSuccessDTO
        Controller --> UI : Return QualificationSuccessDTO
        UI --> Operator : Display success message
    end
end

== List Qualifications ==

Operator -> UI : Request list of Qualifications (filter by code/name)
UI -> Controller : ListQualifications(filterDTO)
Controller -> Service : ListQualifications(filterDTO)
Service -> Repository : Query Qualifications with filters
Repository --> Service : List<QualificationDTO>
Service --> Controller : List<QualificationDTO>
Controller --> UI : List<QualificationDTO>
UI --> Operator : Display list of qualifications

@enduml
